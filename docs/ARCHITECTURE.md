# üèó Architecture

–ü—Ä–æ—î–∫—Ç: eSvitlo-monitor-bot  
–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç–∞: –æ–ø–∏—Å –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏ —Ç–∞ –ø—Ä–∞–≤–∏–ª –≤–∑–∞—î–º–æ–¥—ñ—ó –º—ñ–∂ —á–∞—Å—Ç–∏–Ω–∞–º–∏ —Å–∏—Å—Ç–µ–º–∏.

–¶–µ–π –¥–æ–∫—É–º–µ–Ω—Ç ‚Äî –¥–∂–µ—Ä–µ–ª–æ –ø—Ä–∞–≤–¥–∏ –¥–ª—è GitHub Copilot —Ç–∞ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞.

---

## 1. –ó–ê–ì–ê–õ–¨–ù–ê –ê–†–•–Ü–¢–ï–ö–¢–£–†–ù–ê –ú–û–î–ï–õ–¨

–ü—Ä–æ—î–∫—Ç –ø–æ–±—É–¥–æ–≤–∞–Ω–∏–π –∑–∞ –ø—Ä–∏–Ω—Ü–∏–ø–æ–º —Ä–æ–∑–¥—ñ–ª–µ–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç–µ–π:

- Handlers ‚Äî UX —ñ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—è
- Services ‚Äî –±—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∞
- Schedulers ‚Äî —Ñ–æ–Ω–æ–≤—ñ –∑–∞–¥–∞—á—ñ
- State Manager ‚Äî –∫–µ—Ä—É–≤–∞–Ω–Ω—è flow
- Storage ‚Äî –¥–∞–Ω—ñ
- Formatter ‚Äî —Ç–µ–∫—Å—Ç–∏

–ñ–æ–¥–µ–Ω —à–∞—Ä –Ω–µ –ø–æ–≤–∏–Ω–µ–Ω –ø–æ—Ä—É—à—É–≤–∞—Ç–∏ —Ü—é –º–æ–¥–µ–ª—å.

---

## 2. HANDLERS

Handlers –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –¢–Ü–õ–¨–ö–ò –∑–∞:
- –æ–±—Ä–æ–±–∫—É –∫–æ–º–∞–Ω–¥ —ñ callback
- –≤–∏–∫–ª–∏–∫ —Å–µ—Ä–≤—ñ—Å—ñ–≤
- –ø–æ–∫–∞–∑ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É

–ó–∞–±–æ—Ä–æ–Ω–µ–Ω–æ –≤ handlers:
- –±—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∞
- —Ä–æ–±–æ—Ç–∞ –∑ –±–∞–∑–æ—é –Ω–∞–ø—Ä—è–º—É
- ping IP
- scheduler logic

Handlers = thin layer.

---

## 3. SERVICES (–ë–Ü–ó–ù–ï–°-–õ–û–ì–Ü–ö–ê)

–°–µ—Ä–≤—ñ—Å–∏:
- UserService
- ChannelService
- ScheduleService
- IpMonitoringService
- AdminService

–°–µ—Ä–≤—ñ—Å–∏:
- –ù–ï –∑–∞–ª–µ–∂–∞—Ç—å –≤—ñ–¥ Telegram API
- –ù–ï —Ñ–æ—Ä–º—É—é—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
- –ø–æ–≤–µ—Ä—Ç–∞—é—Ç—å –¥–∞–Ω—ñ –∞–±–æ —Å—Ç–∞—Ç—É—Å

–°–µ—Ä–≤—ñ—Å–∏ –º–æ–∂–Ω–∞ —Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –æ–∫—Ä–µ–º–æ –≤—ñ–¥ –±–æ—Ç–∞.

---

## 4. STATE MANAGER

State manager:
- —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π
- –æ–¥–∏–Ω –∞–∫—Ç–∏–≤–Ω–∏–π state –Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- –æ–±—Ä–æ–±–ª—è—î:
  - create
  - update
  - cancel
  - timeout

–ó–∞–±–æ—Ä–æ–Ω–µ–Ω–æ:
- —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ state –≤ –¥–æ–≤—ñ–ª—å–Ω–∏—Ö –º—ñ—Å—Ü—è—Ö
- –æ–±—Ö–æ–¥–∏—Ç–∏ state manager

---

## 5. SCHEDULERS / BACKGROUND TASKS

Schedulers –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –∑–∞:
- –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –≥—Ä–∞—Ñ—ñ–∫—ñ–≤
- IP-–º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥
- debounce
- –ø–µ—Ä—ñ–æ–¥–∏—á–Ω—ñ –∑–∞–¥–∞—á—ñ

–í–∏–º–æ–≥–∏:
- —ñ–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∏–π —Å—Ç–∞—Ä—Ç
- –æ–¥–∏–Ω –µ–∫–∑–µ–º–ø–ª—è—Ä
- –±–µ–∑–ø–µ—á–Ω–∏–π —Ä–µ—Å—Ç–∞—Ä—Ç

Schedulers –ù–ï –≤–∏–∫–ª–∏–∫–∞—é—Ç—å—Å—è –∑ handlers.

---

## 6. –ì–†–ê–§–Ü–ö–ò (DATA-FIRST)

–õ–æ–≥—ñ–∫–∞:
- –ø–∞—Ä—Å–µ—Ä ‚Üí snapshot
- snapshot ‚Üí hash
- hash ‚Üí —Ä—ñ—à–µ–Ω–Ω—è –ø—Ä–æ –ø—É–±–ª—ñ–∫–∞—Ü—ñ—é

–û–∫—Ä–µ–º–æ:
- today_snapshot
- tomorrow_snapshot

–ü—É–±–ª—ñ–∫–∞—Ü—ñ—è –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –¢–Ü–õ–¨–ö–ò –ø—Ä–∏ —Ä–µ–∞–ª—å–Ω—ñ–π –∑–º—ñ–Ω—ñ –¥–∞–Ω–∏—Ö.

---

## 7. IP-–ú–û–ù–Ü–¢–û–†–ò–ù–ì

IP engine:
- –æ–∫—Ä–µ–º–∏–π –º–æ–¥—É–ª—å
- mockable ping
- debounce
- —Å—Ç–∞–Ω–∏: ONLINE / OFFLINE / UNSTABLE / UNKNOWN

Handlers –ª–∏—à–µ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

---

## 8. –ê–î–ú–Ü–ù–ö–ê

–ê–¥–º—ñ–Ω-—Ñ—É–Ω–∫—Ü—ñ—ó:
- pause mode
- debounce
- —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏
- feature flags

–ê–¥–º—ñ–Ω–∫–∞:
- –ù–ï –≤–ø–ª–∏–≤–∞—î –Ω–∞–ø—Ä—è–º—É –Ω–∞ UX
- –ø—Ä–∞—Ü—é—î —á–µ—Ä–µ–∑ —Å–µ—Ä–≤—ñ—Å–∏
- –º–∞—î –ª–æ–≥—É–≤–∞–Ω–Ω—è

---

## 9. –õ–û–ì–ò –¢–ê –°–ü–û–°–¢–ï–†–ï–ñ–£–í–ê–ù–Ü–°–¢–¨

–õ–æ–≥—É–≤–∞—Ç–∏:
- –ø–æ–º–∏–ª–∫–∏
- state transitions
- anti-abuse
- scheduler actions

–õ–æ–≥–∏ –ø–æ–≤–∏–Ω–Ω—ñ –¥–æ–∑–≤–æ–ª—è—Ç–∏ –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏ —Å—Ü–µ–Ω–∞—Ä—ñ–π –ø–æ–¥—ñ–π.

---

## 10. –ê–†–•–Ü–¢–ï–ö–¢–£–†–ù–ò–ô DoD

–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –≤–≤–∞–∂–∞—î—Ç—å—Å—è –¥–æ—Ç—Ä–∏–º–∞–Ω–æ—é, —è–∫—â–æ:
- –Ω–µ–º–∞—î –∑–º—ñ—à—É–≤–∞–Ω–Ω—è —à–∞—Ä—ñ–≤
- –∫–æ–¥ –ª–µ–≥–∫–æ —á–∏—Ç–∞—Ç–∏
- –Ω–æ–≤—ñ —Ñ—ñ—á—ñ –¥–æ–¥–∞—é—Ç—å—Å—è –±–µ–∑ —Ö–∞–æ—Å—É
- Copilot –Ω–µ –ø–æ—Ä—É—à—É—î –ø—Ä–∞–≤–∏–ª–∞

–¶–µ–π –¥–æ–∫—É–º–µ–Ω—Ç —î –æ–±–æ–≤ º—è–∑–∫–æ–≤–∏–º –¥–ª—è –∑–º—ñ–Ω.
