# Load Testing Infrastructure

Навантажувальне тестування для Telegram-бота eSvitlo-monitor-bot.

## Структура

- `scenarios/` - Тестові сценарії для різних рівнів навантаження
- `utils/` - Утиліти для тестування (метрики, генератори даних)
- `mocks/` - Моки для Telegram API та інших зовнішніх сервісів
- `reports/` - Звіти про результати тестування

## Рівні навантаження

### Рівень 1 — Малий
- 50 користувачів
- 10 каналів
- 10 IP для моніторингу

### Рівень 2 — Середній
- 300 користувачів
- 50 каналів
- 50 IP

### Рівень 3 — Високий
- 1 000 користувачів
- 200 каналів
- 200 IP

### Рівень 4 — Стрес
- 5 000+ користувачів
- 1 000 каналів
- 1 000 IP

## Запуск тестів

```bash
# Запуск всіх тестів рівня 1 (малий)
npm run load-test:small

# Запуск всіх тестів рівня 2 (середній)
npm run load-test:medium

# Запуск всіх тестів рівня 3 (високий)
npm run load-test:high

# Запуск стрес-тестів
npm run load-test:stress

# Запуск soak тестів (24-72 години)
npm run load-test:soak

# Запуск тестів відновлення
npm run load-test:recovery

# Запуск всіх тестів
npm run load-test:all
```

## Сценарії тестування

1. **Mass /start** - Масовий запуск команди /start
2. **Wizard under load** - Wizard під навантаженням
3. **Mass graph updates** - Масові оновлення графіків
4. **IP monitoring mass states** - Масові зміни стану IP
5. **Mass channel publications** - Масові публікації в канали
6. **Pause mode under load** - Режим паузи під навантаженням

## Метрики успіху

- Час відповіді бота < 2 секунд
- Відсутність дубльованих повідомлень
- Відсутність падінь бота
- Правильна робота debounce
- Відсутність race conditions
- Стабільність під навантаженням

## Критерії провалу

Тест вважається проваленим якщо:
- Бот падає або зависає
- З'являються дубльовані повідомлення
- Debounce не працює
- Scheduler'и дублюються
- State плутається між користувачами
- Бот не відновлюється після перезапуску
